---
title: "Final Project"
output:
  pdf_document: default
  html_document: default
  word_document: default
author: Andrew Cramer, Jaime Gomez Acebo Botin Sanz de Sautuola, Phaedra Letrou, and Natasha Weiss
---


```{r setup }

#Some handy libraries
library(car)
library(leaps)
library(lubridate)
library(rvest)

```

```{r}
# We should edit to read in the way they wanted. I just added the data set to my global enviornment and then read it in.
# NOTE: If you're looking for this data, see the file uploaded called imdbTop250.csv
data <- imdbTop250

#I added this here (Phaedra)
data <- read.csv("imdbTop250.csv", header = TRUE, stringsAsFactors = FALSE)

# Show variable names and dimensions.
dim(data)
names(data)

# Show the first six rows.
head(data)

# Get rid of useless column.
data <- data[, -3]
```

```{r}
# Only keeping data with cmomplete observations (Jaime)
data <- data[complete.cases(data),]

# Keep only the first genre for each movie (we can change this later, but it just seemed easier) (Jaime)
data$First_Genre <- sapply(strsplit(as.character(data$Genre), ", "), function(x) x[1])

# Box plot of Gross income v. Genre (Jaime)
boxplot(data$Gross ~ data$First_Genre,
        main = "Return by Genre",
        ylab = "Gross Return",
        xlab = "Genre",
        col = c(2:7),
        cex.axis = 0.4
        )

# Plots to visualize some relationships (Jaime)
plot(Gross ~ Votes, data = data)
plot(Votes ~ Ranking, data = data)
plot(Gross ~ Date, data = data)

# Correlation Matrix with our continuous variables (Jaime)
(cor_matrix <- cor(data[, c("Rating", "Votes", "Gross")]))
```

#new variable for log(Gross) (Phaedra) 
imdb_data$logGross <- log(imdb_data$Gross) (Phaedra)

#checking the distribution of the new variable (Phaedra)
hist(imdb_data$logGross)

#create a new variable for sqrt(Rating) (Phaedra)
imdb_data$sqrtRating <- sqrt(imdb_data$Rating)

#checking the distrib of the new variable (Phaedra)
hist(imdb_data$sqrtRating)

#calculating the corr between Rating and Gross (Phaedra)
cor(imdb_data$Rating, imdb_data$Gross)

#Performing a linear regression of Rating on Gross (phaedra)
lm(Rating ~ Gross, data = imdb_data)

#There is only one observation with first genre "Family", only two with first genre "Documentary", and twenty-six with first genre "Film-Noir". Because there aren't enough observations in these categories to be able to compare them on boxplots (natasha)
table(data$First_Genre)
#Combining Film Noir, Documentary, and Family under a new Miscellaneous category of first genre (natasha)
data$First_Genre <- gsub("(Documentary|Family|Film-Noir)", "Miscellaneous", data$First_Genre)
#Histogram of Rating Frequency (natasha)
hist(data$Rating, col = "lightblue", main = "Frequency of Rating", xlab = "Rating")
#NATASHA: Histogram of Run Time Frequency (natasha)
hist(data$RunTime, col = "lightblue", main = "Frequency of Run Time", xlab = "Run Time (min)")


#Get the directors with the most films in the top 250 (natasha)
top10directors <- names(sort(table(data$Director), decreasing = TRUE)[1:10])
#Get the all the rows with these directors (natasha)
top10rows <- subset(data, Director %in% top10directors)
#Make a boxplot of log of gross revenue by director with the top ten directors (natasha)
boxplot(log(top10rows$Gross) ~ top10rows$Director,
        main = "Return by Top Ten Directors",
        ylab = "Log of Gross Revenue",
        xlab = "Director",
        col = c(2:11),
        cex.axis = 0.3
        )


